仓库已知缺陷与 **`UserProfileService`** 相关。请围绕这个类完成：**稳定复现 → 定位根因 → 最小修复 → 回归验证**，并输出一份问题处理 **QA 文档**。要求 `mvn test` 必须通过，禁止吞异常/绕过逻辑“假修复”。

### 验收（全部满足）

1. 提供稳定复现方式：优先新增自动化测试（JUnit/并发测试等）或可执行脚本
2. 修复后不再复现，回归通过
3. 输出根因与修复说明（原因、修复点、风险、如何验证）
4. `mvn test` 通过
5. 新增 QA 文档文件并写全内容

### 约束

- 不允许吞异常、catch 忽略、临时 return、跳过核心逻辑来规避问题
- 根因必须定位到 `UserProfileService` 及其交互处的具体方法/代码段
- 必须新增至少 1 个回归用例防止复发

### 输出顺序（必须按顺序）

1. **复现方式**：前置条件 + 命令 + 复现现象
2. **定位结果**：关键证据 + 根因位置（类/方法/条件）
3. **修复方案与关键改动**：按文件列出要点
4. **验证命令与期望结果**：修复前后对比 + `mvn test`
5. **变更文件清单**
6. **QA 文档**：新增 `docs/bugfix-sessionregistry-userdirectory-qa.md`（如无 docs 目录则创建），用中文问答写：
   - 问题是什么/影响范围
   - 如何复现（命令）
   - 根因是什么（指向代码）
   - 怎么修（改动点）
   - 如何验证/回归
   - 风险与监控建议